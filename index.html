<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Table Export to Excel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container my-4">
        <h2 class="mb-4">ข้อมูลน้ำประปา</h2>
        <table class="table table-striped" id="dataTable">
            <thead>
                <tr>
                    <th>ลำดับ</th>
                    <th>นลย.1</th>
                    <th>นลย.2</th>
                    <th>นลย.3</th>
                    <!-- เพิ่มหัวข้อเพิ่มเติมที่นี่ -->
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>123</td>
                    <td>456</td>
                    <td>789</td>
                    <!-- เพิ่มข้อมูลเพิ่มเติมที่นี่ -->
                </tr>
                <!-- เพิ่มแถวเพิ่มเติมที่นี่ -->
            </tbody>
        </table>
        <button id="exportBtn" class="btn btn-primary">Export to Excel</button>
    </div>

    <script>
        document.getElementById('exportBtn').addEventListener('click', function () {
            let data = [];
            let table = document.getElementById('dataTable');
            let rows = table.querySelectorAll('tr');
            
            rows.forEach(row => {
                let rowData = [];
                let cells = row.querySelectorAll('th, td');
                cells.forEach(cell => {
                    rowData.push(cell.innerText);
                });
                data.push(rowData);
            });

            let worksheet = XLSX.utils.aoa_to_sheet(data);
            let workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');
            XLSX.writeFile(workbook, 'data.xlsx');
        });
    </script>
</body>
</html>
