<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Upload</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1 class="my-4">Upload Excel and Display as Table</h1>
        <form id="uploadForm">
            <div class="mb-3">
                <label for="excelFile" class="form-label">Choose Excel File</label>
                <input class="form-control" type="file" id="excelFile" accept=".xlsx, .xls">
            </div>
            <button type="submit" class="btn btn-primary">Upload</button>
        </form>
        <hr>
        <div id="tableContainer" class="mt-4">
            <table id="excelTable" class="table table-bordered">
                <thead>
                    <!-- Table header will be generated dynamically -->
                </thead>
                <tbody>
                    <!-- Table body will be generated dynamically -->
                </tbody>
            </table>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
document.getElementById('uploadForm').addEventListener('submit', function (e) {
    e.preventDefault();
    let fileInput = document.getElementById('excelFile');
    let file = fileInput.files[0];
    if (file) {
        let reader = new FileReader();
        reader.onload = function (e) {
            let data = new Uint8Array(e.target.result);
            let workbook = XLSX.read(data, { type: 'array' });
            let firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            let jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
            displayTable(jsonData);
        };
        reader.readAsArrayBuffer(file);
    }
});

function displayTable(data) {
    let table = document.getElementById('excelTable');
    let thead = table.querySelector('thead');
    let tbody = table.querySelector('tbody');

    // Clear existing content
    thead.innerHTML = '';
    tbody.innerHTML = '';

    // Generate table header
    let headerRow = document.createElement('tr');
    data[0].forEach(header => {
        let th = document.createElement('th');
        th.textContent = header;
        headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);

    // Generate table body
    data.slice(1).forEach(row => {
        let tr = document.createElement('tr');
        row.forEach(cell => {
            let td = document.createElement('td');
            td.textContent = cell;
            tr.appendChild(td);
        });
        tbody.appendChild(tr);
    });
}



      
    </script>
</body>
</html>
